<?php

$text = '<p>Dieses E-Zigaretten-Set besteht aus dem ergonomisch gestalteten Akkuträger asMODus Amighty und dem asMODus Viento Verdampfer. Der Viento ist auf das Dampfen im sog. Direct-Lung Stil ausgelegt, bei dem der Dampf direkt in die Lunge inhaliert wird.</p>
<h2><strong>asMODus Amighty</strong></h2>
<p>Der Amighty liegt durch sein ergonomisches Design besonders angenehm in der Hand. Das Gerät ist mit einem gut und angenehm zu tastenden Feuerknopf ausgestattet.</p>
<p>Der Amighty wird wahlweise mit einer 20700er oder 21700er Akkuzelle betrieben. Über einen Adapter kann auch ein 18650er Akku verwendet werden. Die Akkuzelle kann über ein externes Akku-Ladegerät oder über den Micro-USB Anschluss des Gerätes aufgeladen werden.</p>
<p>Das Herz des Amighty ist der effiziente GX-200UTC Chip. Das Betriebssystem des Geräts ist update-fähig. Für ein Software-Update verbinden Sie den Amighty über den USB Anschluss mit einem Laptop oder PC.&nbsp;</p>
<p>Der Amighty verfügt über die Dampf Modi POWER (Watt-Modus), TC (Temperatur-Modus) und TCR (individueller Temperator-Modus). Darüber hinaus kann eine persönliche Watt-Kurve festgelegt werden (CURVE-Modus). Für individuelle Watt-Kurven stehen Ihnen fünf Speicherplätze zur Verfügung. Der Temperatur-Modus unterstützt Wicklungen aus Titan, Nickel und Edelstahl. Im TCR-Modus haben Sie die Möglichkeit, Temperaturkoeffizienten für weitere Drahtsorten individuell festzulegen. Es stehen Ihnen dabei Speicherplätze für fünf Drahtsorten zur Verfügung.</p>
<p>Im Watt-Modus liegt die Ausgangsleistung des Amighty zwischen 5 und 100 Watt.&nbsp;Im Temperatur-Modus liegt die Leistung zwischen 5&nbsp; und 60 Watt bei einem einstellbaren Temperaturbereich von 100° bis 300° Celsius.&nbsp;</p>
<p>Auf dem farbigen HD Touch Display werden Ihnen die eingestellte Wattzahl oder Temperatur, die Anzahl der getätigten Züge, der Ladestand des Akkus sowie der Widerstand des Verdampferkopfs angezeigt. Über das Touch Display nehmen Sie auch Ihre individuellen Einstellungen vor. Das Farbschema des Displays lässt sich durch einen Wisch nach unten ändern.</p>
<p>Der Amighty verfügt über die von asMODus bekannten ausgereiften Schutzschaltungen. Sie schützen die Akkuzellen vor Tiefenentladung, Überladung, Verpolung, Kurzschluss und Überhitzung. Bei einem Kurzschluss oder niedrigem Akkustand wird dies auf dem Display angezeigt und über eine kurze Vibration signalisiert. Die Vibrationsfunktion kann über das Menu abgeschaltet werden.</p>
<p>Der Amighty ist mit einem&nbsp; 510er Gewindeanschluss ausgestattet. Sie können mit diesem Gerät Verdampfer bis zu einem maximalen Durchmesser von 29 mm an der Basis ohne Überstand verwenden.</p>
<h2><strong>asMODus Viento</strong></h2>
<p>Der im Lieferumfang befindliche Viento Verdampfer wird über ein Top Filling-System von oben mit E-Liquid befüllt. Über eine regelbare Airflow-Control können Sie die Luftbeimischung durch die drei Lufteinlässe nach Ihren Wünschen anpassen. Die Regelung erfolgt über einen in der Basis des Verdampfers eingebauten Einstellring für alle Lufteinlässe gleichzeitig.</p>
<p>Das Tankvolumen des Viento beträgt 3,5 ml in der Standard-Variante. Es lässt sich durch Einsatz des separat erhältlichen Bubble-Glastanks auf 5 ml erweitern. Der Glastank besteht aus Pyrex-Glas. Die Oberfläche dieses Materials ist besonders glatt und verhält sich deshalb auch bei einem Wechsel des E-Liquids weitestgehend geschmacksneutral.</p>
<p>Die mitgelieferten beiden Verdampferköpfe mit jeweils 0,18 Ohm können in einem Leistungsbereich von 40 Watt bis 60 Watt betrieben werden. Anders als bei klassischen Verdampferköpfen verdampft das Liquid bei diesen Mesh Heads nicht an einem einfachen Draht, sondern an einer Netzstruktur (Mesh). Die im Vergleich zum einfachen Draht deutlich größere Oberfläche ermöglicht ein gleichmäßigeres Verdampfen des E-Liquids auch bei hohem Volumen. Neben den Original-Verdampferköpfen können Sie im asMODus Viento auch Verdampferköpfe für die Smok Baby Beast Serie verwenden, da diese kompatibel sind.</p>
<p>Der Viento Verdampfer ist mit einem 510er Gewindeanschluss ausgestattet. Der Durchmesser des Viento beträgt an der Basis 26,9 mm.&nbsp;Das 810er Mundstück des Viento sorgt für einen angenehm großzügigen Dampfstrom.</p>
<h2><strong>Fazit</strong></h2>
<p>Der asMODus Amighty ist ein Akkuträger in cooler Optik. Er bietet sehr weitreichende und feine Konfigurationsmöglichkeiten für das temperaturgeregelte Dampfen. Insbesondere kennt der Amighty verschiedene Edelstahlsorten von Hause aus. Für Verdampferspulen aus ungewöhnlichen Materialien lassen sich Temperaturkoeffizienten individuell hinterlegen. Für Freunde des temperaturgeregelten Dampfens ist der asMODus Amighty ein Gerät erster Wahl.</p>
<p>Der asMODus Viento Verdampfer überzeugt mit sehr guter Geschmacks- und Dampfproduktion. Optisch passt er hervorragend zum asMODus Amighty. Alles in allem besitzen Sie mit dieser Kombination eine E-Zigarette, die optisch und haptisch sehr gut abgestimmt wirkt, und von den Möglichkeiten, das Dampferlebnis zu tunen, keine Wünsche übrig lässt.</p>
<h2>Eigenschaften asMODus Amighty Akkuträger</h2>
<table frame="void" rules="rows" cellspacing="0" cellpadding="2" border="5">
<tbody>
<tr>
<td valign="middle">Stromversorgung</td>
<td>20700er oder 21700er Akkuzelle, 18650er Akkuzelle über Adapter<br> (Akkuzellen sind nicht im Lieferumfang enthalten)</td>
</tr>
<tr>
<td>Ausgabemodi</td>
<td>POWER | TEMP (SS304, SS316, SS317, Ti, Ni200) | TCR | TFR | CURVE</td>
</tr>
<tr>
<td>Prozessor</td>
<td>GX-100UTC</td>
</tr>
<tr>
<td>Ausgangsleistung</td>
<td>5 – 100 Watt (POWER) | 5 - 60 Watt (TEMP)</td>
</tr>
<tr>
<td>Ausgangsspannung</td>
<td>1 - 7,5 Volt</td>
</tr>
<tr>
<td>Temperaturbereich</td>
<td>100 °C – 300 °C | 212° - 572° F</td>
</tr>
<tr>
<td>Widerstandsbereich</td>
<td>0,1 – 3 Ohm</td>
</tr>
<tr>
<td>Ladestrom</td>
<td>DC 5V/1A</td>
</tr>
<tr>
<td>Gewindetyp</td>
<td>510</td>
</tr>
<tr>
<td>Besondere Merkmale</td>
<td>HD Farb Touch Display, update-fähig</td>
</tr>
<tr>
<td>Maße</td>
<td>88 mm x 51,4 mm x 31,1 mm</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>Eigenschaften asMODus Viento Verdampfer</h2>
<table frame="void" rules="rows" cellspacing="0" cellpadding="2" border="5">
<tbody>
<tr>
<td>Tankvolumen</td>
<td>3,5 ml</td>
</tr>
<tr>
<td>Durchmesser</td>
<td>26,9 mm</td>
</tr>
<tr>
<td>Gewindetyp</td>
<td>510</td>
</tr>
<tr>
<td>Mundstück</td>
<td>810</td>
</tr>
<tr>
<td>Material</td>
<td>Pyrex-Glas und Edelstahl</td>
</tr>
<tr>
<td>Airflow Control</td>
<td>3 Einlässe, Einstellring an der Basis</td>
</tr>
<tr>
<td>Befüllung</td>
<td>Top Filling, Befüllung von oben</td>
</tr>
<tr>
<td>Stil</td>
<td>Direct Lung, Direkte Lungeninhalation</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2><strong>Lieferumfang</strong></h2>
<ul>
<li>1 x Amighty 100 Watt Akkuträger</li>
<li>1 x Viento Clearomizer</li>
<li>2 x 0.18 Ohm Mesh Heas</li>
<li>1 x Micro USB Kabel</li>
<li>1 x Ersatz-Teile</li>
<li>1 x Ersatz-Glastank</li>
<li>1 x Bedienungsanleitung</li>
</ul>';

class HtmlDocument
{
    /**
     * Extrahiere aus einem Html-Text alle Tabellen und liefere das Ergebnis als Array zurück.
     * Die linke Spalte der Tabelle dient als Array-Key, die anderen Spalten werden zu einem String implodiert,
     * mit MXC_DELIMITER_1 als Trenner zwischen den Zellen.
     *
     * @return array
     */
    public function getTablesAsArray(string $text)
    {
        $document = $this->getDOMDocument($text);
        $result = [];
        $tables = $document->getElementsByTagName('table');
        if ($tables->count() === 0) {
            return $result;
        }

        foreach ($tables as $table) {
            $rows = $table->getElementsByTagName('tr');
            if ($rows->count() === 0) {
                continue;
            }
            $i = 0;

            $temp = [];
            foreach ($rows as $row) {
                $cells = $row->getElementsByTagName('td');
                foreach ($cells as $cell) {
                    $temp[$i][] = trim($cell->textContent);
                }
                $i++;
            }

            $array = [];
            foreach ($temp as $line) {
                $topic = $line[0];
                unset($line[0]);
                $line = implode('#!#', $line);
                $array[$topic] = $line;
            }
            $result[] = $array;
        }
        return $result;
    }

    public function getScopeOfDelivery(string $text, bool $removeLineBreaks) {

        $offset = strrpos($text, '<ul>');
        if ($offset === false) return '';
        $result = substr($text, $offset);
        $result = preg_replace('~</?li>~','', $result);
        $result = preg_replace('~</?ul>~','', $result);
        if ($removeLineBreaks) {
            $result = preg_replace('~\r?\n|\r~', '#!#', $result);
            $result = explode('#!#', $result);
            $result = implode(' ', $result);
        }

        return trim($result);
    }

    protected function getDOMDocument(string $text)
    {
        $text = preg_replace('~<br/?>~', "\n", $text);
        $document = new DOMDocument();
        $document->loadHTML($text);
        return $document;
    }
}

$doc = new HtmlDocument();
// var_export($doc->getTablesAsArray($text));
var_export($doc->getScopeOfDelivery($text, true));